<!DOCTYPE html>
<html>
<head>
	<style>

	</style>
</head>
<body>
	<script src="/socket.io/socket.io.js"></script>
	<script type="text/javascript">
		var socket = io();
		var roomCode;
		var isLeader;
		var currentEvent;

		socket.on("newRoom", function(roomNum){
			console.log(roomNum)
			roomCode = roomNum;
			document.getElementById('joinRoom').value = roomCode
		});

		socket.on("newEventDetails", function(newEventDetails){
			currentEvent = newEventDetails;
			roomCode = newEventDetails.id;
			document.getElementById('joinRoom').value = roomCode
			document.getElementById('newEventTime').value = newEventDetails.time;
			document.getElementById('newEventLocation').value = newEventDetails.location;
			document.getElementById('newEventDetails').value = newEventDetails.details;
		})

		var createRoom = function(){
			socket.emit("createRoom");
			isLeader = true;
		}

		var joinRoom = function(){
			socket.emit("joinRoom", parseInt(document.getElementById('joinRoom').value));
			isLeader = false;
		}

		var newEvent = function(){
			var newEvent = {id: roomCode, time: document.getElementById('newEventTime').value, location: document.getElementById('newEventLocation').value, details: document.getElementById('newEventDetails').value}
			console.log(newEvent);
			if(isLeader){
				socket.emit("updateEventDetails",newEvent);
				return;
			}else{
				document.getElementById('joinRoom').value = roomCode
				document.getElementById('newEventTime').value = currentEvent.time;
				document.getElementById('newEventLocation').value = currentEvent.location;
				document.getElementById('newEventDetails').value = currentEvent.details;
			}
		}

	</script>
	<input type="button" value="Create Room!" onclick="createRoom();"></input>

	<div>Room Code:<input id="joinRoom" type="text" name="Room Code"></input></div>
	<input id="joinRoomSend" type="button" value="Join Room!" onclick="joinRoom()"></input>
	<div>Time:<input id="newEventTime" type="text"></input></div>
	<div>Location:<input id="newEventLocation" type="text"></input></div>
	<div>Details:<input id="newEventDetails" type="text"></input></div>
	<input type="button" value="Post New Event!" onclick="newEvent()"></input>
</body>
</html>